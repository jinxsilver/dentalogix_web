<%- include('../partials/header') %>

<main class="blog-page">
  <div class="container">
    <div class="section-header">
      <span class="section-label">Our Blog</span>
      <h1><%= typeof category !== 'undefined' ? 'Category: ' + category.name : 'Dental Health Insights' %></h1>
      <p>Stay informed with the latest tips, news, and updates from our dental practice.</p>
    </div>
    
    <div class="blog-layout">
      <div class="blog-main">
        <% if (posts.length > 0) { %>
        <div class="blog-grid">
          <% posts.forEach(function(post) { %>
          <a href="/blog/<%= post.slug %>" class="blog-card">
            <div class="blog-image">
              <% if (post.featured_image) { %>
                <img src="<%= post.featured_image %>" alt="<%= post.title %>">
              <% } else { %>
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="M21 15l-5-5L5 21"/></svg>
              <% } %>
            </div>
            <div class="blog-content">
              <div class="blog-meta">
                <% if (post.category_name) { %>
                <span class="blog-category"><%= post.category_name %></span>
                <% } %>
                <span class="blog-date"><%= new Date(post.published_at).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' }) %></span>
              </div>
              <h3><%= post.title %></h3>
              <p class="blog-excerpt"><%= post.excerpt %></p>
            </div>
          </a>
          <% }); %>
        </div>
        
        <% if (totalPages > 1) { %>
        <div class="pagination">
          <% if (currentPage > 1) { %>
            <a href="/blog?page=<%= currentPage - 1 %>">←</a>
          <% } %>
          <% for (let i = 1; i <= totalPages; i++) { %>
            <% if (i === currentPage) { %>
              <span class="active"><%= i %></span>
            <% } else { %>
              <a href="/blog?page=<%= i %>"><%= i %></a>
            <% } %>
          <% } %>
          <% if (currentPage < totalPages) { %>
            <a href="/blog?page=<%= currentPage + 1 %>">→</a>
          <% } %>
        </div>
        <% } %>
        
        <% } else { %>
        <div class="empty-state" style="text-align: center; padding: 4rem;">
          <svg style="width: 80px; height: 80px; color: var(--color-gray-300);" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
          <h3>No Posts Yet</h3>
          <p>Check back soon for new content!</p>
        </div>
        <% } %>
      </div>
      
      <aside class="blog-sidebar">
        <div class="sidebar-widget">
          <h4>Categories</h4>
          <ul class="category-list">
            <li><a href="/blog" class="<%= typeof category === 'undefined' ? 'active' : '' %>">All Posts</a></li>
            <% categories.forEach(function(cat) { %>
            <li><a href="/blog/category/<%= cat.slug %>" class="<%= typeof category !== 'undefined' && category.id === cat.id ? 'active' : '' %>"><%= cat.name %></a></li>
            <% }); %>
          </ul>
        </div>
        
        <div class="sidebar-widget">
          <h4>Need Dental Care?</h4>
          <p style="color: var(--color-gray-500); margin-bottom: 1rem;">Schedule your appointment today and experience the difference.</p>
          <a href="/contact" class="btn btn-primary btn-sm" style="width: 100%;">Book Appointment</a>
        </div>
      </aside>
    </div>
  </div>
</main>

<%- include('../partials/footer') %>
